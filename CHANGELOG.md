# Saneject Changelog

## Version 0.8.2

### Packaging
- Added Unity Package Manager (UPM) support.
- Package can now be installed directly via Git URL:  
  `https://github.com/alexanderlarsen/Saneject.git?path=UnityProject/Saneject/Assets/Plugins/Saneject`
- No changes to runtime or editor functionality.

## Version 0.8.1

### CI/Testing
- Added assembly definition files for runtime and test code to ensure CI discovers and runs tests consistently across Unity versions.
- Moved test `Resources` folder into a folder covered by an assembly definition so `Resources.Load` works in CI.
- Updated test setup to automatically bypass injection confirmation prompts when running in batch mode, fixing mass test failures in CI.
- Confirmed automated tests now pass for all supported Unity versions.

### Editor
- No functional changes to runtime/editor features, only improvements to test reliability and CI integration.

## Version 0.8.0

Saneject is now confirmed to work from 2022.3.12f LTS.

### Backwards Compatibility

- Swap `TextMeshProUGUI` components and references with `UnityEngine.UI.Text`.
- Removed new Unity input system and updated demo scripts to use old input system.
- Added extension `GetComponentIndexCompat` with preprocessor version check, so versions older than Unity 2022 versions don't call `component.GetComponentIndex()` that doesn't exist.

### Editor

- Renamed `MonoBehaviourInspector` to `MonoBehaviourFallbackInspector` and made it a true fallback so it only applies when no more specific custom inspector exists.
- Added `SanejectInspector` public API for integrating Saneject’s injection-aware inspector features into custom editors.
- Introduced unified `SanejectInspector.DrawDefault` method to restore the full Saneject inspector UI/UX in a single call from any custom inspector.

### CI/Testing

- Added automated test runs for oldest/newest 2022 LTS, 6.0 LTS, plus latest 6.1 and 6.2.

## Version 0.7.1

- Allow `[Inject]` attribute to be used with public fields without `[SerializeField]`.
- Small refactor in the `Scope` binding API: `BindComponent<TComponent>()` and single generic variations are now `BindComponent<T>()`, to make it clearer that `T` can be both interface and concrete.

## Version 0.7.0

### API Changes

- Refactored binding API to be more type-safe via generics. The API now returns only appropriate binding methods depending on whether you're binding assets or components.
- Added support for collection bindings using `BindMultipleComponents<T>()`, `BindMultipleComponents<TInterface, TConcrete>()`, and shorthand aliases `BindComponents<T>()` and `BindComponents<TInterface, TConcrete>()`.
- Added support for multiple bindings of the same type, allowing interface injection with different concretes based on the injection target using `.WhereTargetIs<T>()`.
- Enforced stricter resolution rules: interface bindings no longer resolve concrete fields.
- Added support for interface-only bindings, e.g. `BindComponent<IInterface>()`, useful for resolving collections of different concrete implementations.
- Removed dependency injector caching due to problems with target filtering and multi-binding resolution.
- `Scope.GetBindingRecursivelyUpwards()` now respects target filters and no longer returns the first match unconditionally.

### Validation & Error Handling

- Improved validation and error handling across the binding system.
- Binding configuration issues (missing, conflicting, unused bindings) are now reported in a single pass without halting injection flow.
- Added extended validation for binding declarations to detect invalid or contradictory configurations.

### Inspector & UI

- Removed legacy property drawers. All field rendering is now handled by `MonoBehaviourInspector` and `SanejectInspector`.
- Inspector draws injected collections (arrays/lists) as read-only, grayed-out UI with no editing controls.
- Interface field sync logic (`ISerializationCallbackReceiver.OnBeforeSerialize`) is now generated by Roslyn and no longer depends on `PropertyDrawer`, improving robustness.
- Tooltips added to all toggles in `UserSettingsEditorWindow`.
- Serialize interface backing fields and generated serialization methods are now hidden from IntelliSense to prevent accidental misuse.

### Testing

- Added 225 unit tests covering core functionality and edge cases. All tests are passing.

### Bug Fixes

- Fixed a bug where `[SerializeInterface]` did not work correctly in nested `[Serializable]` classes.
- Fixed a bug where interface bindings incorrectly resolved concrete fields.

## Version 0.6.0

### Roslyn Analyzers & Code Fixes

- Added a new Roslyn analyzer (`AttributesAnalyzer.dll`) that validates:
    - `[Inject]` fields must also have `[SerializeField]` or `[SerializeInterface]`.
    - `[SerializeInterface]` can only be applied to fields of interface type.
- Added code fixes that offer context-aware actions to add, remove, or correct attribute usage.
- Updated Roslyn tools documentation and reorganized project structure for clarity.

See [Roslyn Tools in Saneject](https://github.com/alexanderlarsen/Saneject?tab=readme-ov-file#roslyn-tools-in-saneject) for more details.
